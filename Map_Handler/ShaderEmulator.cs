using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.IO;
using System.Xml;
using System.Globalization;
using BlamLib;
using DATA_STRUCTURES;

namespace Map_Handler
{
    public partial class ShaderEmulator : Form
    {
        public void EmulateShaderDumpToolStripMenuItem_Click(object sender, EventArgs e)
        {
            OpenFileDialog fbd = new OpenFileDialog();

            MessageBox.Show("Please select the Shader Log.");

            if (fbd.ShowDialog() == System.Windows.Forms.DialogResult.OK)
            {
                string filePath = Path.Combine(Environment.CurrentDirectory, "plugins", "shaderstemplates", "blank.shader");
                string shaderpath = Path.GetDirectoryName(fbd.FileName);
                string tagfolder = Path.Combine(shaderpath, "TAGS");
                string workingdirectory = Environment.CurrentDirectory;
                Directory.CreateDirectory(tagfolder);

                foreach (string line in File.ReadLines(fbd.FileName))
                {
                    var sectionShaderParameter = File.ReadAllLines(Path.Combine(shaderpath, line))
                        .SkipWhile(s => s != "### SHADER PARAMETERS ###")     // Skip up to the header
                        .Skip(1)                                              // Skip the header
                        .TakeWhile(s => s != "### SHADER PARAMETERS END ###") // Take lines until the end
                        .ToList();                                            // Convert the result to List<string>

                    string ShaderTemplate = Path.GetFileName(sectionShaderParameter[0]) + ".shader_template.txt";

                    string PixelTemplate = Path.GetFileName(sectionShaderParameter[0]) + ".shader_template_pixel.txt";

                    var sectionBitmap = File.ReadAllLines(Path.Combine(shaderpath, line))
                        .SkipWhile(s => s != "### BITMAPS ###")               // Skip up to the header
                        .Skip(1)                                              // Skip the header
                        .TakeWhile(s => s != "### BITMAPS END ###")           // Take lines until the end
                        .ToList();                                            // Convert the result to List<string>

                    var sectionBitmapLabels = File.ReadAllLines(Path.Combine(workingdirectory, "plugins", "shaderstemplates", ShaderTemplate))
                        .ToList();

                    var sectionPixelLabels = File.ReadAllLines(Path.Combine(workingdirectory, "plugins", "pixeltemplates", PixelTemplate))
                        .ToList();

                    var sectionLightmap = File.ReadAllLines(Path.Combine(shaderpath, line))
                        .SkipWhile(s => s != "### LIGHTMAP ###")              // Skip up to the header
                        .Skip(1)                                              // Skip the header
                        .TakeWhile(s => s != "### LIGHTMAP END ###")          // Take lines until the end
                        .ToList();

                    var sectionPixelConstant = File.ReadAllLines(Path.Combine(shaderpath, line))
                        .SkipWhile(s => s != "### PIXEL CONSTANTS ###")       // Skip up to the header
                        .Skip(1)                                              // Skip the header
                        .TakeWhile(s => s != "### PIXEL CONSTANTS END ###")   // Take lines until the end
                        .ToList();                                            // Convert the result to List<string>

                    var sectionVertexConstant = File.ReadAllLines(Path.Combine(shaderpath, line))
                        .SkipWhile(s => s != "### VERTEX CONSTANTS ###")      // Skip up to the header
                        .Skip(1)                                              // Skip the header
                        .TakeWhile(s => s != "### VERTEX CONSTANTS END ###")  // Take lines until the end
                        .ToList();

                    List<string> SectiomItems = new List<string>();
                    SectiomItems.AddRange(sectionBitmapLabels);
                    SectiomItems.AddRange(sectionPixelLabels);

                    List<string> SectiomItemLength = new List<string>();
                    SectiomItemLength.AddRange(sectionBitmap);
                    for (int i = 0; i < sectionPixelLabels.Count; i++)
                    {
                        SectiomItemLength.Add("");
                    }

                    List<string> SupportedShaders = new List<string>();

                    SupportedShaders.Add("active_camo_opaque.shader_template.txt");
                    SupportedShaders.Add("active_camo_transparent.shader_template.txt");
                    SupportedShaders.Add("add_illum_detail.shader_template.txt");
                    SupportedShaders.Add("ammo_meter.shader_template.txt");
                    SupportedShaders.Add("bloom.shader_template.txt");
                    SupportedShaders.Add("bumped_environment_additive.shader_template.txt");
                    SupportedShaders.Add("bumped_environment_blended.shader_template.txt");
                    SupportedShaders.Add("bumped_environment_darkened.shader_template.txt");
                    SupportedShaders.Add("bumped_environment_mask_colored.shader_template.txt");
                    SupportedShaders.Add("bumped_environment_masked.shader_template.txt");
                    SupportedShaders.Add("cortana.shader_template.txt");
                    //SupportedShaders.Add("cortana_holographic_active_camo.shader_template.txt");
                    SupportedShaders.Add("illum.shader_template.txt");
                    SupportedShaders.Add("illum_3_channel_opaque.shader_template.txt");
                    SupportedShaders.Add("illum_bloom.shader_template.txt");
                    SupportedShaders.Add("illum_bloom_opaque.shader_template.txt");
                    SupportedShaders.Add("illum_clamped.shader_template.txt");
                    SupportedShaders.Add("illum_detail.shader_template.txt");
                    SupportedShaders.Add("illum_opaque.shader_template.txt");
                    SupportedShaders.Add("one_add_illum.shader_template.txt");
                    SupportedShaders.Add("one_add_illum_detail.shader_template.txt");
                    SupportedShaders.Add("one_alpha_env_illum.shader_template.txt");
                    SupportedShaders.Add("one_alpha_env_illum_specular_mask.shader_template.txt");
                    SupportedShaders.Add("tex_bump.shader_template.txt");
                    SupportedShaders.Add("tex_bump_dprs_env_illum.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env.shader_template.txt");
                    //SupportedShaders.Add("tex_bump_env_dbl_spec.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_3_channel.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_3_channel_combined.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_3_channel_occlusion_combined.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_combined.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_detail_honor_guard.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_four_change_color_no_lod.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_two_change_color.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_illum_two_change_color_combined.shader_template.txt");
                    SupportedShaders.Add("tex_bump_env_two_change_color_multiply_map_self_illum.shader_template.txt");
                    SupportedShaders.Add("tex_bump_illum.shader_template.txt");
                    SupportedShaders.Add("tex_bump_illum_3_channel.shader_template.txt");
                    SupportedShaders.Add("tex_bump_illum_alpha_test.shader_template.txt");
                    SupportedShaders.Add("tex_bump_illum_bloom.shader_template.txt");
                    SupportedShaders.Add("tex_bump_meter_illum.shader_template.txt");
                    SupportedShaders.Add("tex_bump_plasma_one_channel_illum.shader_template.txt");
                    SupportedShaders.Add("two_add_env_illum.shader_template.txt");
                    SupportedShaders.Add("two_add_env_illum_3_channel.shader_template.txt");
                    SupportedShaders.Add("two_add_env_illum_active_camo.shader_template.txt");
                    SupportedShaders.Add("two_alpha_env_illum.shader_template.txt");



                    string[] BitmapLabels = File.ReadAllLines(Path.Combine(workingdirectory, "plugins", "shaderstemplates", ShaderTemplate));

                    string[] PixelLabels = File.ReadAllLines(Path.Combine(workingdirectory, "plugins", "pixeltemplates", PixelTemplate));

                    int ShaderParameterCount = BitmapLabels.GetLength(0);

                    int PixelParameterCount = PixelLabels.GetLength(0);

                    int ItemParameterCount = ShaderParameterCount + PixelParameterCount;

                    string tagname = Path.Combine(tagfolder, line.Substring(0, (line.Length - 4)) + ".shader");
                    Directory.CreateDirectory(Directory.GetParent(tagname).ToString());

                    using (var fs = new FileStream(filePath, FileMode.OpenOrCreate, FileAccess.ReadWrite))
                    using (var ds = new FileStream(tagname, FileMode.Create, FileAccess.ReadWrite))
                    using (var ms = new MemoryStream())
                    using (var bw = new BinaryWriter(ms))
                    using (var br = new BinaryReader(ms))

                    {
                        fs.CopyTo(ms);
                        ms.Position = 0;

                        bw.BaseStream.Seek(88, SeekOrigin.Begin);
                        bw.Write(Convert.ToInt32(sectionShaderParameter[0].Length));           //Write shader path length
                        bw.BaseStream.Seek(99, SeekOrigin.Begin);
                        bw.Write(Convert.ToInt32(sectionShaderParameter[1].Length));           //Write material_name length
                        bw.BaseStream.Seek(114, SeekOrigin.Begin);
                        bw.Write(Convert.ToByte(sectionShaderParameter[2]));                   //Write Flags 1 byte = water 2 byte = sort first 4 byte = no active camo
                        bw.BaseStream.Seek(116, SeekOrigin.Begin);
                        if (!SupportedShaders.Contains(ShaderTemplate))
                        {
                            bw.Write(Convert.ToInt32(ShaderParameterCount)); //Write parameter count
                        }
                        else
                        {
                            bw.Write(Convert.ToInt32(ShaderParameterCount + PixelParameterCount)); //Write parameter count
                        }
                        bw.BaseStream.Seek(172, SeekOrigin.Begin);
                        bw.Write(Convert.ToByte(sectionShaderParameter[9]));                   //Write shader_lod_bias
                        bw.BaseStream.Seek(174, SeekOrigin.Begin);
                        bw.Write(Convert.ToByte(sectionShaderParameter[5]));                   //Write dynamic_light_specular_type value
                        bw.BaseStream.Seek(176, SeekOrigin.Begin);
                        bw.Write(Convert.ToByte(sectionShaderParameter[6]));                   //Write lightmap_type value
                        bw.BaseStream.Seek(180, SeekOrigin.Begin);
                        bw.Write(Convert.ToSingle(sectionShaderParameter[7]));                 //Write lightmap_specular_brightness value
                        bw.Write(Convert.ToSingle(sectionShaderParameter[8]));                 //Write lightmap_ambient_bias value
                        bw.BaseStream.Seek(200, SeekOrigin.Begin);
                        bw.Write(Convert.ToSingle(sectionShaderParameter[3]));                 //Write depth_bias_offset value
                        bw.Write(Convert.ToSingle(sectionShaderParameter[4]));                 //Write depth_bias_slope_scale value

                        bw.BaseStream.Seek(208, SeekOrigin.Begin);

                        bw.Write(Encoding.UTF8.GetBytes(sectionShaderParameter[0]));           //Write shader path
                        bw.Write(Convert.ToByte(0));
                        bw.Write(Encoding.UTF8.GetBytes(sectionShaderParameter[1]));           //Write material_name
                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                        bw.Write(Convert.ToInt32(0));
                        if (!SupportedShaders.Contains(ShaderTemplate))
                        {
                            bw.Write(Convert.ToInt32(ShaderParameterCount)); //Write parameter count
                        }
                        else
                        {
                            bw.Write(Convert.ToInt32(ShaderParameterCount + PixelParameterCount)); //Write parameter count
                        }
                        bw.Write(Convert.ToInt32(52));

                        if (!SupportedShaders.Contains(ShaderTemplate))
                        {
                            for (int i = 0; i < ShaderParameterCount; i++)
                            {
                                if (sectionBitmap[i] == " ")
                                {
                                    sectionBitmap[i] = "";
                                }

                                bw.Write(Convert.ToInt16(0));

                                byte[] flip = new byte[2];
                                flip = BitConverter.GetBytes(Convert.ToInt16(BitmapLabels[i].Length));
                                Array.Reverse(flip);

                                bw.Write(BitConverter.ToInt16(flip, 0));
                                bw.Write(Convert.ToInt32(0));
                                bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                bw.Write(Convert.ToInt32(0));
                                bw.Write((Convert.ToInt32(sectionBitmap[i].Length)));
                                bw.Write(Convert.ToInt32(-1));

                                bw.Write(Convert.ToInt32(0));
                                bw.Write(Convert.ToInt32(0));
                                bw.Write(Convert.ToInt32(0));
                                bw.Write(Convert.ToInt32(0));
                                bw.Write(Convert.ToInt32(0));
                                // 5 time 5 time 5 time 5 time 5 time WCW Champion

                                bw.Write(Convert.ToInt32(-1));

                                bw.Write(Convert.ToInt32(10088844));
                            }
                        }
                        else
                        {
                            for (int i = 0; i < ItemParameterCount; i++)
                            {
                                float b = 0.00392156862f;

                                if (SectiomItems[i] == " ")
                                {
                                    SectiomItems[i] = "";
                                }

                                if (i >= ShaderParameterCount)
                                {
                                    SectiomItemLength[i] = "";
                                }

                                #region Active Camo Opaque
                                if (ShaderTemplate == "active_camo_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "refraction_bump_amount")     //vertex constant index 2 x value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //A
                                        bw.Write(Convert.ToSingle(0));                  //R
                                        bw.Write(Convert.ToSingle(0));                  //G
                                        bw.Write(Convert.ToSingle(0));                  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "refraction_geometry_amount") //vertex constant index 3 y value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //A
                                        bw.Write(Convert.ToSingle(0));                  //R
                                        bw.Write(Convert.ToSingle(0));                  //G
                                        bw.Write(Convert.ToSingle(0));                  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Active Camo Transparent
                                if (ShaderTemplate == "active_camo_transparent.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "refraction_bump_amount")     //vertex constant index 2 x value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //A
                                        bw.Write(Convert.ToSingle(0));                  //R
                                        bw.Write(Convert.ToSingle(0));                  //G
                                        bw.Write(Convert.ToSingle(0));                  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "refraction_geometry_amount") //vertex constant index 3 y value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //A
                                        bw.Write(Convert.ToSingle(0));                  //R
                                        bw.Write(Convert.ToSingle(0));                  //G
                                        bw.Write(Convert.ToSingle(0));                  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Add Illum Detail
                                if (ShaderTemplate == "add_illum_detail.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[i].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[i].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));

                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[i].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")        //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));               //A
                                        bw.Write(Convert.ToSingle(0));               //R
                                        bw.Write(Convert.ToSingle(0));               //G
                                        bw.Write(Convert.ToSingle(0));               //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_color") //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));               //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_power") //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0));               //R
                                        bw.Write(Convert.ToSingle(0));               //G
                                        bw.Write(Convert.ToSingle(0));               //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Ammo Meter
                                if (ShaderTemplate == "ammo_meter.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "meter_gradient_min") //pixel constants index 1 value - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));          //A
                                        bw.Write(Convert.ToSingle(0));          //R
                                        bw.Write(Convert.ToSingle(0));          //G
                                        bw.Write(Convert.ToSingle(0));          //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_gradient_max") //pixel constants index 2 value - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));          //A
                                        bw.Write(Convert.ToSingle(0));          //R
                                        bw.Write(Convert.ToSingle(0));          //G
                                        bw.Write(Convert.ToSingle(0));          //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_empty_color")  //pixel constants index 3 value - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));          //A
                                        bw.Write(Convert.ToSingle(0));          //R
                                        bw.Write(Convert.ToSingle(0));          //G
                                        bw.Write(Convert.ToSingle(0));          //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_amount")       //pixel constants index 0 value - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));          //A
                                        bw.Write(Convert.ToSingle(0));          //R
                                        bw.Write(Convert.ToSingle(0));          //G
                                        bw.Write(Convert.ToSingle(0));          //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Bloom
                                if (ShaderTemplate == "bloom.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "lightmap_emissive_map")       //pixel constants index 0 value - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));          //A
                                        bw.Write(Convert.ToSingle(0));          //R
                                        bw.Write(Convert.ToSingle(0));          //G
                                        bw.Write(Convert.ToSingle(0));          //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom_map")       //pixel constants index 0 value - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));          //A
                                        bw.Write(Convert.ToSingle(0));          //R
                                        bw.Write(Convert.ToSingle(0));          //G
                                        bw.Write(Convert.ToSingle(0));          //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_color") //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));               //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_power") //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0));               //R
                                        bw.Write(Convert.ToSingle(0));               //G
                                        bw.Write(Convert.ToSingle(0));               //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom")                   //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));               //A
                                        bw.Write(Convert.ToSingle(0));               //R
                                        bw.Write(Convert.ToSingle(0));               //G
                                        bw.Write(Convert.ToSingle(0));               //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Additive
                                if (ShaderTemplate == "bumped_environment_additive.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bump_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color") //vertex constant index 1 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")          //vertex constant index 2 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness") //vertex constant index 3 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")          //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));               //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")          //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0));               //R
                                        bw.Write(Convert.ToSingle(0));               //G
                                        bw.Write(Convert.ToSingle(0));               //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Blended
                                if (ShaderTemplate == "bumped_environment_blended.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bump_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_translucent_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")             //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")    //vertex constant index 1 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")             //vertex constant index 2 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")    //vertex constant index 3 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")             //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")             //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0));                  //R
                                        bw.Write(Convert.ToSingle(0));                  //G
                                        bw.Write(Convert.ToSingle(0));                  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_translucent_color") //runtime properites tag block lightmap transparent colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[6]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[7]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[8]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_translucent_alpha") //runtime properties tag block lightmap transparent alpha - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[5]))); //A
                                        bw.Write(Convert.ToSingle(0));                  //R
                                        bw.Write(Convert.ToSingle(0));                  //G
                                        bw.Write(Convert.ToSingle(0));                  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Darkened
                                if (ShaderTemplate == "bumped_environment_darkened.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bump_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //vertex constant index 0 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //vertex constant index 1 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //vertex constant index 2 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //vertex constant index 3 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                                         //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                         //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Mask Colored
                                if (ShaderTemplate == "bumped_environment_mask_colored.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bump_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //vertex constant index 0 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //vertex constant index 1 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //vertex constant index 2 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //vertex constant index 3 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                                         //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                         //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "mask_color0")                //pixel constant index 1 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "mask_color1")                //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "mask_color2")                //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Masked
                                if (ShaderTemplate == "bumped_environment_masked.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bump_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //vertex constant index 0 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //vertex constant index 1 x,y,z rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //vertex constant index 2 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //vertex constant index 3 w value - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                                         //runtime properites tag block lightmap emissive colors value - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                         //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Cortana
                                if (ShaderTemplate == "cortana.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "flat_environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "noise_map_a")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "noise_map_b")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[6].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[7].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bump_map")          //vertex constant index 0 x,y,z rgb floats - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[8].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "flat_environment_color")     //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")          //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")        //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")                 //vertex constant index 0 rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")        //vertex constant index 1 rgb floats - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")                 //vertex constant index 2 alpha float - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")        //vertex constant index 3 alpha float - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "color_wide")                 //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "color_medium")               //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "color_sharp")                //pixel constant index 8 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[18].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0)); //A
                                        bw.Write(Convert.ToSingle(0)); //R
                                        bw.Write(Convert.ToSingle(0)); //G
                                        bw.Write(Convert.ToSingle(0)); //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "perpendicular_brightness")   //vertex constant index 21 alpha float - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[19].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[84]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[85]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[86]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[87]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "fade_bias")                  //pixel constant index 7 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[20].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[28]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[29]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[30]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[31]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom")                      //pixel constant index 4 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[21].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")             //vertex constant index 23 rgb float - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[22].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[92]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[93]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[94]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[95]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")    //vertex constant index 24 rgb float - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[23].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[96]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[97]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[98]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[99]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")             //vertex constant index 25 rgb float - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[24].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[100]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[101]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[102]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[103]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")    //vertex constant index 26 rgb float - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[25].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[104]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[105]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[106]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[107]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor")   //pixel constant index 9 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[26].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[36]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[37]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[38]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[39]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color")    //pixel constant index 10 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[27].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[40]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[41]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[42]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[43]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Cortana Holographic Active Camo
                                /*if (ShaderTemplate == "cortana_holographic_active_camo.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "refraction_bump_amount")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "refraction_geometry_amount")                                        //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "refraction_x_offset")                               //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }*/
                                #endregion

                                #region Illum
                                if (ShaderTemplate == "illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Illum 3 Channel Opaque
                                if (ShaderTemplate == "illum_3_channel_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region illum Bloom
                                if (ShaderTemplate == "illum_bloom.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "add_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "mult_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom")                                        //pixel constant index 1 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region illum Bloom Opaque
                                if (ShaderTemplate == "illum_bloom_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "add_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "mult_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom")                                        //pixel constant index 1 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region illum Clamped
                                if (ShaderTemplate == "illum_clamped.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region illum Detail
                                if (ShaderTemplate == "illum_detail.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region illum Opaque
                                if (ShaderTemplate == "illum_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region One Add Illum
                                if (ShaderTemplate == "one_add_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")                                   //vertex constant index 2 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")                          //vertex constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")                                   //vertex constant index 4 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")                          //vertex constant index 5 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emmisive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emmisive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region One Add Illum Detail
                                if (ShaderTemplate == "one_add_illum_detail.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 0 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")                                   //vertex constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")                          //vertex constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")                                   //vertex constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")                          //vertex constant index 7 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region One Alpha Env Illum
                                if (ShaderTemplate == "one_alpha_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_color")                             //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")                            //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")                          //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")                                          //vertex constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")                                 //vertex constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")                                          //vertex constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")                                 //vertex constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region One Alpha Env Illum Specular Mask
                                if (ShaderTemplate == "one_alpha_env_illum_specular_mask.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_color")                             //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")                            //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")                          //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")                             //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")                                          //vertex constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")                                 //vertex constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")                                          //vertex constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")                                 //vertex constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                      //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                                     //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                      //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0));                                     //R
                                        bw.Write(Convert.ToInt32(0));                                     //G
                                        bw.Write(Convert.ToInt32(0));                                     //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump
                                if (ShaderTemplate == "tex_bump.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_alphatest_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "ambient_factor")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                        //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(-1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                               //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Dprs Env Illum
                                if (ShaderTemplate == "tex_bump_dprs_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")             //vertex constant index 8 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[32])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[33])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[34])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[35])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //vertex constant index 9 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[36])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[37])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[38])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[39])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //vertex constant index 10 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[40])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[41])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[42])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[43])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")    //vertex constant index 11 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[44])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[45])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[46])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[47])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //vertex constant index 12 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[48])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[49])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[50])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[51])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //vertex constant index 13 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[52])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[53])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[54])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[55])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env
                                if (ShaderTemplate == "tex_bump_env.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "active_camo_bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Dbl Spec
                                /*if (ShaderTemplate == "tex_bump_env_dbl_spec.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }*/
                                #endregion

                                #region Tex Bump Env Illum
                                if (ShaderTemplate == "tex_bump_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "active_camo_bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //Not written to packaged shad tag? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                 //A
                                        bw.Write(Convert.ToInt32(0));                 //R
                                        bw.Write(Convert.ToInt32(0));                 //G
                                        bw.Write(Convert.ToInt32(0));                 //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //Not written to packaged shad tag? - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));                //A
                                        bw.Write(Convert.ToInt32(0));                //R
                                        bw.Write(Convert.ToInt32(0));                //G
                                        bw.Write(Convert.ToInt32(0));                //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum 3 Channel
                                if (ShaderTemplate == "tex_bump_env_illum_3_channel.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_emmisive_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 10 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[40]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[41]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[42]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[43]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 11 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[44]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[45]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[46]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[47]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 12 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[48]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[49]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[50]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[51]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 13 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[52]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[53]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[54]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[55]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color") //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color") //pixel constant index 7 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness") //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color") //pixel constant index 8 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness") //pixel constant index 9 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[18].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[19].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[20].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[21].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum 3 Channel Combined
                                if (ShaderTemplate == "tex_bump_env_illum_3_channel_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color") //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color") //pixel constant index 7 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness") //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color") //pixel constant index 8 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness") //pixel constant index 9 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[18].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[19].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[20].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum 3 Channel Occlusion Combined
                                if (ShaderTemplate == "tex_bump_env_illum_3_channel_occlusion_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "occlusion_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 13 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[52]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[53]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[54]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[55]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 14 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[56]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[57]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[58]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[59]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 15 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[60]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[61]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[62]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[63]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 16 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[64]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[65]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[66]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[67]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color") //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color") //pixel constant index 8 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness") //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color") //pixel constant index 8 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness") //pixel constant index 7 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "occlusion_a_color") //pixel constant index 10 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[18].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "occlusion_b_color") //pixel constant index 11 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[19].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "occlusion_c_color") //pixel constant index 12 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[20].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[21].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[22].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[23].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[24].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Combined
                                if (ShaderTemplate == "tex_bump_env_illum_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "active_camo_bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap emissive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Detail Honor Guard
                                if (ShaderTemplate == "tex_bump_env_illum_detail_honor_guard.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_detail")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map_value_scale")                                 //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "burn_scale")                                             //pixel constant index 0 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap half life - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[4]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                         //vertex constant index 6 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[24])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[25])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[26])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[27])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                                //vertex constant index 7 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                         //vertex constant index 8 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[32])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[33])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[34]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[35]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                                //vertex constant index 9 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[36]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[37]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[38]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[39]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[16]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[19]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 2 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[18].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Four Change Color No Lod
                                if (ShaderTemplate == "tex_bump_env_illum_four_change_color_no_lod.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "active_camo_bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(3));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "change_color_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[6].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "ambient_factor")   //Not written to shad file - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                       //vertex constant index 4 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                              //vertex constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                      //vertex constant index 6 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[24]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[25]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[26]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[27]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                             //vertex constant index 7 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Two Change Color
                                if (ShaderTemplate == "tex_bump_env_illum_two_change_color.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "active_camo_bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(3));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "change_color_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[6].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                       //vertex constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                              //vertex constant index 6 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[24]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[25]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[26]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[27]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                      //vertex constant index 7 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[28]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[29]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[30]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[31]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                             //vertex constant index 8 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[32]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[33]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[34]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[35]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //pixel constant index 3 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[15]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Two Change Color Combined
                                if (ShaderTemplate == "tex_bump_env_illum_two_change_color_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "change_color_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                       //vertex constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                              //vertex constant index 6 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[24])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[25])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[26])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[27])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                      //vertex constant index 7 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                             //vertex constant index 8 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[32]))); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[33]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[34]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[35]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_factor") //Not written to shad file - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_midrange_tint_color") //Not written to shad file - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Two Change Color Multiply Map Self Illum
                                if (ShaderTemplate == "tex_bump_env_two_change_color_multiply_map_self_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "change_color_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "multiply_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(3));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[6].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_tint_color")                                       //vertex constant index 5 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[21]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[23]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_tint_color")                              //vertex constant index 6 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[24]) * b));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[25]) * b));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[26]) * b));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[27]) * b));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_brightness")                                      //vertex constant index 7 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[28]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[29]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[30]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[31]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "env_glancing_brightness")                             //vertex constant index 8 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[32]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[33]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[34]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[35]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")             //Not written to packaged shad file - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")             //Not written to packaged shad file  - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum
                                if (ShaderTemplate == "tex_bump_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(5));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 3 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum 3 Channel
                                if (ShaderTemplate == "tex_bump_illum_3_channel.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color") //pixel constant index 6 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color") //pixel constant index 7 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness") //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness") //pixel constant index 3 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness") //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum Alpha Test
                                if (ShaderTemplate == "tex_bump_illum_alpha_test.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_test_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_alphatest_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[5].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 1 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 2 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum Bloom
                                if (ShaderTemplate == "tex_bump_illum_bloom.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                                //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "bloom") //pixel constant index 3 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Meter Illum
                                if (ShaderTemplate == "tex_bump_meter_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_on_color")   //pixel constant index 3 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_off_color")  //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "meter_value")      //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Tex Bump Plasma One Channel Illum
                                if (ShaderTemplate == "tex_bump_plasma_one_channel_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "base_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "detail_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(2));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "multichannel_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(4));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")  //pixel constant index 5 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")  //pixel constant index 3 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")  //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "time")             //pixel constant index 2 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                               //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_color")                                         //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_glancing_color")                                //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Two Add Env Illum
                                if (ShaderTemplate == "two_add_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_color")  //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")  //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")  //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")  //vertex constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")             //vertex constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")  //vertex constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")             //vertex constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                               //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Two Add Env Illum 3 Channel
                                if (ShaderTemplate == "two_add_env_illum_3_channel.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_color")  //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")  //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")  //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));         //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")  //vertex constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")             //vertex constant index 2 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")  //vertex constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")             //vertex constant index 4 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[17].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                               //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[18].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Two Add Env Illum Active Camo
                                if (ShaderTemplate == "two_add_env_illum_active_camo.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_color")  //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")  //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")  //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")  //vertex constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")             //vertex constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")  //vertex constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")             //vertex constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                               //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion

                                #region Two Alpha Env Illum
                                if (ShaderTemplate == "two_alpha_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "environment_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[0].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[0].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "specular_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[1].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[1].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[2].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[2].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[3].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[3].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_translucent_map")                                        //unused? moved from the shad file to some other file on package? Only used on lighting and thrown away on package? - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[4].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(0));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(SectiomItemLength[4].Length)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(0));                                             //A
                                        bw.Write(Convert.ToSingle(0));                                             //R
                                        bw.Write(Convert.ToSingle(0));                                             //G
                                        bw.Write(Convert.ToSingle(0));                                             //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "environment_color")  //pixel constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[5].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_color")  //pixel constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[6].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[5]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[7]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_opacity")  //pixel constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[7].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b)); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[10]) * b)); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[11]) * b)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "self_illum_color") //pixel constant index 4 - Written as hex color value in a dfbt next to parameter name
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[8].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0));         //A
                                        bw.Write(Convert.ToInt32(0));         //R
                                        bw.Write(Convert.ToInt32(0));         //G
                                        bw.Write(Convert.ToInt32(0));         //B
                                        bw.Write(Convert.ToInt32(1));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "tint_color")  //vertex constant index 0 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[9].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")             //vertex constant index 1 - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[10].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "brightness")  //vertex constant index 2 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[11].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")             //vertex constant index 3 - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[12].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_translucent_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[13].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[6]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[7]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[8]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "lightmap_translucent_alpha")                               //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[14].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[5]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_color")                               //runtime properties tag block lightmap emissive color - written as rgb float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[15].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(2));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(0)); //A
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[1]))); //R
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[2]))); //G
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[3]))); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                    if (SectiomItems[i] == "emissive_power")                               //runtime properties tag block lightmap emmisive power - written as alpha float in mitb block
                                    {
                                        bw.Write(Convert.ToInt16(0));

                                        byte[] flip = new byte[2];
                                        flip = BitConverter.GetBytes(Convert.ToInt16(SectiomItems[16].Length));
                                        Array.Reverse(flip);

                                        bw.Write(BitConverter.ToInt16(flip, 0));
                                        bw.Write(Convert.ToByte(1));                    //Vaue type? 0 = tag reference  1 = float value 2 = color value
                                        bw.Write(Convert.ToByte(0));
                                        bw.Write(Convert.ToInt16(0));
                                        bw.Write(Encoding.UTF8.GetBytes("mtib"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write((Convert.ToInt32(0)));
                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionLightmap[0]))); //A
                                        bw.Write(Convert.ToInt32(0)); //R
                                        bw.Write(Convert.ToInt32(0)); //G
                                        bw.Write(Convert.ToInt32(0)); //B
                                        bw.Write(Convert.ToInt32(0));

                                        bw.Write(Convert.ToInt32(-1));

                                        bw.Write(Convert.ToInt32(10088844));
                                    }
                                }
                                #endregion
                            }
                        }
                        if (!SupportedShaders.Contains(ShaderTemplate))
                        {
                            for (int i = 0; i < ShaderParameterCount; i++)
                            {
                                bw.Write(Encoding.UTF8.GetBytes(BitmapLabels[i]));
                                bw.Write(Encoding.UTF8.GetBytes(sectionBitmap[i]));
                                if (sectionBitmap[i].Length > 0)
                                {
                                    bw.Write(Convert.ToByte(0));
                                }
                            }
                        }
                        else
                        {
                            for (int i = 0; i < ItemParameterCount; i++)
                            {
                                float b = 0.00392156862f;

                                if (SectiomItems[i] == " ")
                                {
                                    SectiomItems[i] = "";
                                }

                                if (i >= ShaderParameterCount)
                                {
                                    SectiomItemLength[i] = "";
                                }

                                bw.Write(Encoding.UTF8.GetBytes(SectiomItems[i]));
                                bw.Write(Encoding.UTF8.GetBytes(SectiomItemLength[i]));

                                if (SectiomItemLength[i].Length > 0)
                                {
                                    bw.Write(Convert.ToByte(0));
                                }

                                #region Add Illum Detail
                                if (ShaderTemplate == "add_illum_detail.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // self illum map translation y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  // detail map scale x - Vertex Constant Index 3 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  // detail map scale y - Vertex Constant Index 3 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  // detail map translation x - Vertex Constant Index 3 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  // detail map translation y - Vertex Constant Index 3 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Ammo Meter
                                if (ShaderTemplate == "ammo_meter.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "meter_gradient_min")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262209520));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[7])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[6]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[5]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[4]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "meter_gradient_max")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208704));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 2 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10])); //G - Pixel constant index 2 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 2 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 2 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "meter_empty_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262211288));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 3 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14])); //G - Pixel constant index 3 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13])); //R - Pixel constant index 3 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 3 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "meter_amount")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208976));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1028443341));   // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));  //A - Pixel constant index 0 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));  //R - Pixel constant index 0 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[2]) * b));  //G - Pixel constant index 0 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[3]) * b));  //B - Pixel constant index 0 RGB value - Written as dfbt block next to parameter name
                                    }
                                }
                                #endregion

                                #region Bloom
                                if (ShaderTemplate == "bloom.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bloom_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "bloom")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[0]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Additive
                                if (ShaderTemplate == "bumped_environment_additive.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // bump map scale x - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // bump map scale y - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Blended
                                if (ShaderTemplate == "bumped_environment_blended.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // bump map scale x - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // bump map scale y - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Darkened
                                if (ShaderTemplate == "bumped_environment_darkened.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // bump map scale x - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // bump map scale y - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Mask Colored
                                if (ShaderTemplate == "bumped_environment_mask_colored.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // bump map scale x - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // bump map scale y - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "mask_color0")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[7])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[6]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[5]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[4]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "mask_color1")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "mask_color2")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Bumped Environment Masked
                                if (ShaderTemplate == "bumped_environment_masked.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // bump map scale x - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // bump map scale y - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Cortana
                                if (ShaderTemplate == "cortana.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "specular_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // bump map scale x - Vertex Constant Index 4 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // bump map scale y - Vertex Constant Index 5 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "alpha_blend_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[33])));  // self illum map scale x - Vertex Constant Index 8 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[38])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[32])));  // self illum map translation x - Vertex Constant Index 8 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[36])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "noise_map_a")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(18868920));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(18871096));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(18871232));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(18871368));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(7));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[61])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[66])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[60])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[64])));  // self illum map translation y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "noise_map_b")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(7));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[69])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[74])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[68])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[72])));  // self illum map translation y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "color_wide")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 6 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 6 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 6 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 6 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "color_medium")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[23])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[22]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[21]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[20]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "color_sharp")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[35])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[34]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[33]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[32]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "alpha_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[77])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[82])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[76])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[80])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Illum
                                if (ShaderTemplate == "illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Illum 3 Channel Opaque
                                if (ShaderTemplate == "illum_3_channel_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[1]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[6]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[19])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[18]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[17]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[16]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region illum Bloom
                                if (ShaderTemplate == "illum_bloom.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "add_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "mult_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "bloom_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "bloom")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region illum Bloom Opaque
                                if (ShaderTemplate == "illum_bloom_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "add_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[15])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "mult_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "bloom_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "bloom")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[4]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region illum Clamped
                                if (ShaderTemplate == "illum_clamped.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region illum Detail
                                if (ShaderTemplate == "illum_detail.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // self illum map translation y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // self illum map translation y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region illum Opaque
                                if (ShaderTemplate == "illum_opaque.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[3])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region One Add Illum
                                if (ShaderTemplate == "one_add_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region One Add Illum Detail
                                if (ShaderTemplate == "one_add_illum_detail.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[0])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[12])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[3])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[2]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[1]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[0]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "tint_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[19])) * 255));  //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[18])) * 255));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[17])) * 255));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[16])) * 255));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "glancing_tint_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[23])) * 255));  //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[22])) * 255));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[21])) * 255));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte((Convert.ToSingle(sectionVertexConstant[20])) * 255));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[24])));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "glancing_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region One Alpha Env Illum
                                if (ShaderTemplate == "one_alpha_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[25])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[24])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region One Alpha Env Illum Specular Mask
                                if (ShaderTemplate == "one_alpha_env_illum_specular_mask.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump
                                if (ShaderTemplate == "tex_bump.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  // base map scale x - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // base map scale y - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  // base map translation x - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map translation y - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // detail map scale x - Vertex Constant Index 2 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // detail map scale y - Vertex Constant Index 2 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Dprs Env Illum
                                if (ShaderTemplate == "tex_bump_dprs_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env
                                if (ShaderTemplate == "tex_bump_env.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum
                                if (ShaderTemplate == "tex_bump_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum 3 Channel
                                if (ShaderTemplate == "tex_bump_env_illum_3_channel.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[45])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[46])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[47])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[44])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[31])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[30]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[29]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[28]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[35])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[34]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[33]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[32]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[36]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum 3 Channel Combined
                                if (ShaderTemplate == "tex_bump_env_illum_3_channel_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[21])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[22])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[23])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[20])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[35])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[34]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[33]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[32]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[25]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[39])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[38]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[37]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[36]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[30]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[43])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[42]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[41]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[40]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[44]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum 3 Channel Occlusion Combined
                                if (ShaderTemplate == "tex_bump_env_illum_3_channel_occlusion_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[45])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[46])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[47])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[44])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "occlusion_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[49])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[50])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[51])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[48])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[17]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[35])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[34]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[33]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[32]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[22]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[39])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[38]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[37]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[36]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[28]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "occlusion_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[43])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[42]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[41]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[40]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "occlusion_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[47])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[46]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[45]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[44]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "occlusion_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[51])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[50]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[49]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[48]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Combined
                                if (ShaderTemplate == "tex_bump_env_illum_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Detail Honor Guard
                                if (ShaderTemplate == "tex_bump_env_illum_detail_honor_guard.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_detail")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[53])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[54])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map_value_scale")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[24]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[23])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[22]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[21]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[20]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Four Change Color No Lod
                                if (ShaderTemplate == "tex_bump_env_illum_four_change_color_no_lod.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(3));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278333936));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278335024));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278334072));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[45])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[46])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[47])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[44])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[19])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[18]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[17]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[16]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Two Change Color
                                if (ShaderTemplate == "tex_bump_env_illum_two_change_color.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(3));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278333936));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278335024));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278334072));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[19])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[18]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[17]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[16]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Illum Two Change Color Combined
                                if (ShaderTemplate == "tex_bump_env_illum_two_change_color_combined.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Env Two Change Color Multiply Map Self Illum
                                if (ShaderTemplate == "tex_bump_env_two_change_color_multiply_map_self_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "change_color_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "multiply_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(3));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278333936));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278335024));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(278334072));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[37])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[38])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum
                                if (ShaderTemplate == "tex_bump_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(5));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288064));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110285616));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110288472));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286568));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(13));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(110286296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29])));  // base map scale x - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30])));  // base map scale y - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31])));  // base map translation x - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));  // base map translation y - Vertex Constant Index 1 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum 3 Channel
                                if (ShaderTemplate == "tex_bump_illum_3_channel.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[17])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[18])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[19])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[16])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[19])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[18]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[17]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[16]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[31])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[30]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[29]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[28]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[9]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[14]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[20]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum Alpha Test
                                if (ShaderTemplate == "tex_bump_illum_alpha_test.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "alpha_test_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[13])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[14])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[7])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[6]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[5]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[4]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Tex Bump Illum Bloom
                                if (ShaderTemplate == "tex_bump_illum_bloom.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "base_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[5])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[6])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[7])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[4])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[11])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[8])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "bloom_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[33])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[34])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[35])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[32])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[11])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[10]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[9]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[8]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "bloom")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[12]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Meter Illum
                                if (ShaderTemplate == "tex_bump_meter_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "meter_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "meter_on_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "meter_off_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[19])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[18]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[17]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[16]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "meter_value")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Tex Bump Plasma One Channel Illum
                                if (ShaderTemplate == "tex_bump_plasma_one_channel_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "bump_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[1])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[2])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "detail_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568720));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108568856));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[9])));  // bump map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[10])));  // bump map scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "multichannel_map")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(4));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208840));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(2));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208296));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(4));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262208432));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Convert.ToInt32(5));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(262210608));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[29])));  // self illum map scale x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[30])));  // self illum scale y - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[31])));  // self illum map translation x - Vertex Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionVertexConstant[28])));  // base map index - Bitmap index value in bitmap tag block or overlay - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[23])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[22]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[21]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[20]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[19])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[18]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[17]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[16]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "time")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[8]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Two Add Env Illum
                                if (ShaderTemplate == "two_add_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Two Add Env Illum 3 Channel
                                if (ShaderTemplate == "two_add_env_illum_3_channel.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "channel_a_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[23])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[22]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[21]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[20]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_a_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[13]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_b_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[27])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[26]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[25]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[24]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_b_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[18]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                    if (SectiomItems[i] == "channel_c_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[31])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[30]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[29]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[28]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                    if (SectiomItems[i] == "channel_c_brightness")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(11));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(289601248));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToSingle(Convert.ToSingle(sectionPixelConstant[32]) * b));   // Bloom value - Pixel Constant Index 0 - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1065353216));
                                        bw.Write(Convert.ToInt32(1065353216));
                                    }
                                }
                                #endregion

                                #region Two Add Env Illum Active Camo
                                if (ShaderTemplate == "two_add_env_illum_active_camo.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion

                                #region Two Alpha Env Illum
                                if (ShaderTemplate == "two_alpha_env_illum.shader_template.txt")
                                {
                                    if (SectiomItems[i] == "self_illum_color")
                                    {
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1));  //Transform count?
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(108177048));
                                        bw.Write(Convert.ToInt32(9449588));
                                        bw.Write(Encoding.UTF8.GetBytes("PPAM"));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(12));
                                        bw.Write(Encoding.UTF8.GetBytes("dfbt"));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(28));
                                        bw.Write(Convert.ToInt32(1));
                                        bw.Write(Convert.ToInt32(8193));
                                        bw.Write(Convert.ToByte(sectionPixelConstant[15])); //B - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[14]));  //G - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[13]));  //R - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToByte(sectionPixelConstant[12]));  //A - Pixel constant index 1 RGB value - Written as dfbt block next to parameter name
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                        bw.Write(Convert.ToInt32(0));
                                        bw.Write(Convert.ToInt32(1056997504));
                                    }
                                }
                                #endregion
                            }
                        }
                        ms.Position = 0;
                        ds.Position = 0;
                        ms.CopyTo(ds);

                        ms.Close();
                        fs.Close();
                        ds.Close();
                    }
                }
                MessageBox.Show("Finished Creating Tags");
            }
        }
    }
}
